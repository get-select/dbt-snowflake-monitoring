# Changelog
All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html),
and is generated by [Changie](https://github.com/miniscruff/changie).

## dbt-snowflake-monitoring 5.4.5 - May 09, 2025

### Features

- Deduplicate query history ([#182](https://github.com/get-select/dbt-snowflake-monitoring/pull/182))

### Contributors
- [@sergeykhar](https://github.com/sergeykhar) (Features)


## dbt-snowflake-monitoring 5.4.4 - May 8, 2025

### Fixes

- Fix nested json access where the casing of the key has inadvertently changed ([#174](https://github.com/get-select/dbt-snowflake-monitoring/pull/174))

## dbt-snowflake-monitoring 5.4.3 - March 24, 2025

### Features

- Update locator to use account name ([#177](https://github.com/get-select/dbt-snowflake-monitoring/pull/177))



## dbt-snowflake-monitoring 5.4.2 - February 27, 2025

### Fixes

- Fix AI services spend ([#176](https://github.com/get-select/dbt-snowflake-monitoring/pull/176))



## dbt-snowflake-monitoring 5.4.1 - February 11, 2025

### Fixes

- Fix bug in hourly_spend introduced on 5.4.0 ([#175](https://github.com/get-select/dbt-snowflake-monitoring/pull/175))

### Contributors
- [@fernandobrito](https://github.com/fernandobrito) (Fixes)


## dbt-snowflake-monitoring 5.4.0 - February 06, 2025

### Features

- Support all services by default in hourly_spend ([#173](https://github.com/get-select/dbt-snowflake-monitoring/pull/173))

### Contributors
- [@fernandobrito](https://github.com/fernandobrito) (Features)


## dbt-snowflake-monitoring 5.3.3 - January 31, 2025

### Fixes

- Fix column dependencies in stg_query_history ([#171](https://github.com/get-select/dbt-snowflake-monitoring/pull/171))



## dbt-snowflake-monitoring 5.3.2 - January 31, 2025

Several user-contributed fixes and improvements.

## dbt-snowflake-monitoring 5.3.1 - August 23, 2024

### Features

- Add lookback variable to stg_query_history ([#163](https://github.com/get-select/dbt-snowflake-monitoring/pull/163))

### Contributors
- [@smitsrr](https://github.com/smitsrr) (Features)


## dbt-snowflake-monitoring 5.3.0 - June 15, 2024

### Features

- Add new fields for stg_serverless_task_history ([#160](https://github.com/get-select/dbt-snowflake-monitoring/pull/160))

### Contributors
- [@fernandobrito](https://github.com/fernandobrito) (Features)


## dbt-snowflake-monitoring 5.2.2 - June 09, 2024

### Features

- Pull out stg_warehouse_events_history ([#159](https://github.com/get-select/dbt-snowflake-monitoring/pull/159))



## dbt-snowflake-monitoring 5.2.1 - June 09, 2024

### Features

- Remove warehouse_cluster_status model ([#158](https://github.com/get-select/dbt-snowflake-monitoring/pull/158))



## dbt-snowflake-monitoring 5.2.0 - May 28, 2024

### Features

-  Add root_query_id, parent_query_id to stg_access_history ([#156](https://github.com/get-select/dbt-snowflake-monitoring/pull/156))

### Contributors
- [@tnightengale](https://github.com/tnightengale) (Features)


## dbt-snowflake-monitoring 5.1.2 - May 23, 2024

### Fixes

- Fix incremental filtering ([#254](https://github.com/get-select/dbt-snowflake-monitoring/pull/254))



## dbt-snowflake-monitoring 5.1.1 - May 14, 2024

### Fixes

- Include overage spend on services recently introduced ([#154](https://github.com/get-select/dbt-snowflake-monitoring/pull/154))

### Contributors
- [@fernandobrito](https://github.com/fernandobrito) (Fixes)


## dbt-snowflake-monitoring 5.1.0 - May 06, 2024

### Features

- Support more usage types ([#152](https://github.com/get-select/dbt-snowflake-monitoring/pull/152))

### Fixes

- Update to use new service_type values ([#151](https://github.com/get-select/dbt-snowflake-monitoring/pull/151))
- Calculate net cloud services costs for reader accounts ([#153](https://github.com/get-select/dbt-snowflake-monitoring/pull/153))

### Contributors
- [@fernandobrito](https://github.com/fernandobrito) (Features)
- [@stumelius](https://github.com/stumelius) (Fixes)


## dbt-snowflake-monitoring 5.0.4 - March 15, 2024

### Fixes

- Support different order json comment ([#148](https://github.com/get-select/dbt-snowflake-monitoring/pull/148))



## dbt-snowflake-monitoring 5.0.3 - January 16, 2024

### Features

- Add dbt_snowflake_monitoring_incremental_days to set incremental lookback period ([#140](https://github.com/get-select/dbt-snowflake-monitoring/pull/140))

### Contributors
- [@smitsrr](https://github.com/smitsrr) (Features)


## dbt-snowflake-monitoring 5.0.2 - January 15, 2024

### Fixes

- Fix handling of service_type ([#143](https://github.com/get-select/dbt-snowflake-monitoring/pull/143))



## dbt-snowflake-monitoring 5.0.1 - January 15, 2024

### Fixes

- Switch stg_metering_history to a table incrementalization to handle natural dupes ([#142](https://github.com/get-select/dbt-snowflake-monitoring/pull/142))



## dbt-snowflake-monitoring 5.0.0 - January 14, 2024

### Features

- Add query acceleration costs and update cost per query algorithm to include them ([#141](https://github.com/get-select/dbt-snowflake-monitoring/pull/141))
- Make cost_per_query model incremental ([#141](https://github.com/get-select/dbt-snowflake-monitoring/pull/141))

### Breaking Changes

- Add entity_id to stg_metering_history ([#141](https://github.com/get-select/dbt-snowflake-monitoring/pull/141))

To upgrade from 4.x.x, you'll need to full refresh the `stg_metering_history` model.

### Fixes

- Support quoting: true ([#139](https://github.com/get-select/dbt-snowflake-monitoring/pull/139))

### Contributors
- [@ernestoongaro](https://github.com/ernestoongaro) (Fixes)
## dbt-snowflake-monitoring 4.6.0 - November 09, 2023

### Features

- Add credit consumption to cost per query ([#127](https://github.com/get-select/dbt-snowflake-monitoring/pull/127))
- Add query parameterized hash ([#137](https://github.com/get-select/dbt-snowflake-monitoring/pull/137))

### Fixes
- Support quoting: true ([#139](https://github.com/get-select/dbt-snowflake-monitoring/pull/139))

### Contributors
- [@sidhreddy](https://github.com/sidhreddy) (Features)
- [@yingyingqiqi](https://github.com/yingyingqiqi) (Features)
- [@ernestoongaro](https://github.com/ernestoongaro) (Features)

## dbt-snowflake-monitoring 4.5.3 - November 06, 2023

### Features

- Remove regex UDF to avoid timeout ([#135](https://github.com/get-select/dbt-snowflake-monitoring/pull/135))



## dbt-snowflake-monitoring 4.5.2 - October 30, 2023

### Fixes

- Fix cluster number ([#134](https://github.com/get-select/dbt-snowflake-monitoring/pull/134))



## dbt-snowflake-monitoring 4.5.1 - August 24, 2023

### Fixes

- Sort remaining balance daily with null contract numbers last ([#128](https://github.com/get-select/dbt-snowflake-monitoring/pull/128))



## dbt-snowflake-monitoring 4.5.0 - August 09, 2023

### Features

- Add Snowpipe Streaming ([#125](https://github.com/get-select/dbt-snowflake-monitoring/pull/125))



## dbt-snowflake-monitoring 4.4.1 - July 28, 2023

### Features

- Remove unneeded data_transfer_history source and stg model ([#124](https://github.com/get-select/dbt-snowflake-monitoring/pull/124))



## dbt-snowflake-monitoring 4.4.0 - July 26, 2023

### Features

- Add Data Transfer costs ([#123](https://github.com/get-select/dbt-snowflake-monitoring/pull/123))



## dbt-snowflake-monitoring 4.3.1 - June 23, 2023

### Features

- Set range for dbt_snowflake_query_tags ([#121](https://github.com/get-select/dbt-snowflake-monitoring/pull/121))



## dbt-snowflake-monitoring 4.3.0 - June 21, 2023

### Features

- Add hourly_spend model ([#116](https://github.com/get-select/dbt-snowflake-monitoring/pull/116))



## dbt-snowflake-monitoring 4.2.1 - June 03, 2023

### Fixes

- Daily rates improvements ([#114](https://github.com/get-select/dbt-snowflake-monitoring/pull/114))



## dbt-snowflake-monitoring 4.2.0 - May 27, 2023

### Features

- Add node_meta to dbt_query model ([#109](https://github.com/get-select/dbt-snowflake-monitoring/pull/109))

### Contributors
- [@pratik60](https://github.com/pratik60) (Features)


## dbt-snowflake-monitoring 4.1.1 - May 12, 2023

### Features

- Support dbt 1.5.0 ([#106](https://github.com/get-select/dbt-snowflake-monitoring/pull/106))



## dbt-snowflake-monitoring 4.1.0 - May 05, 2023

### Features

- Add currency to all models with spend data ([#103](https://github.com/get-select/dbt-snowflake-monitoring/pull/103))

### Contributors
- [@calleo](https://github.com/calleo) (Features)


## dbt-snowflake-monitoring 4.0.2 - April 08, 2023

### Fixes

- Prevent daily_spend from being held up by missing data ([#97](https://github.com/get-select/dbt-snowflake-monitoring/pull/97))



## dbt-snowflake-monitoring 4.0.1 - April 07, 2023

### Fixes

- Don't let daily_spend be held up by stale rates ([#95](https://github.com/get-select/dbt-snowflake-monitoring/pull/95))



## dbt-snowflake-monitoring 4.0.0 - March 21, 2023

### Breaking Changes

- Rename access_history models ([#92](https://github.com/get-select/dbt-snowflake-monitoring/pull/92))



## dbt-snowflake-monitoring 3.0.1 - March 01, 2023

### Fixes

- Fix dbt_cloud_url var ([#90](https://github.com/get-select/dbt-snowflake-monitoring/pull/90))

### Contributors
- [@vinooganesh](https://github.com/vinooganesh) (Fixes)


## dbt-snowflake-monitoring 3.0.0 - February 26, 2023
After attempting to use only query comments or query tags in versions 1 and 2, we've learned we actually need both. The reasons for that are:
* The `is_incremental` macro is only available from within the query tag dbt context, and is needed to determine whether a model run is incremental or not.
* Query tags have a maximum character limit of 2000, which is easily exceeded by a list of refs containing more than a few models.

To upgrade from 2.x.x, follow the latest instructions in the [Quickstart](https://github.com/get-select/dbt-snowflake-monitoring#quickstart). The package is still able to process query metadata generated by previous versions of the package, so no data will be lost on upgrade.

### Breaking Changes

- Use query comments and query tags to avoid query tag character limit ([#87](https://github.com/get-select/dbt-snowflake-monitoring/pull/87))

## dbt-snowflake-monitoring 2.0.2 - February 21, 2023

### Fixes

- Use the model database and schema for UDF creation ([#83](https://github.com/get-select/dbt-snowflake-monitoring/pull/83))



## dbt-snowflake-monitoring 2.0.1 - February 17, 2023

### Features

- Add spend_net_cloud_services ([#80](https://github.com/get-select/dbt-snowflake-monitoring/pull/80))



## dbt-snowflake-monitoring 2.0.0 - February 08, 2023
The most significant change in 2.0.0 is using query tags instead of comments to attach dbt metadata to queries. To upgrade from previous versions:

1. Remove the query comment configuration from `dbt_project.yml`
2. Follow the instructions to configure the query tag in the [Quickstart](https://github.com/get-select/dbt-snowflake-monitoring#quickstart).

### Breaking Changes

- Switch to using query tags instead of comments ([#78](https://github.com/get-select/dbt-snowflake-monitoring/pull/78))



## dbt-snowflake-monitoring 1.6.1 - February 03, 2023

### Fixes

- Fixes is_incremental in get_query_comment macro ([#77](https://github.com/get-select/dbt-snowflake-monitoring/pull/77))



## dbt-snowflake-monitoring 1.6.0 - February 01, 2023

### Features

- Add query_object_access and query_table_access models ([#73](https://github.com/get-select/dbt-snowflake-monitoring/pull/73))



## dbt-snowflake-monitoring 1.5.0 - January 25, 2023

### Fixes

- Fix query_text_no_comments regex ([#72](https://github.com/get-select/dbt-snowflake-monitoring/pull/72))



## dbt-snowflake-monitoring 1.4.3 - January 20, 2023

### Fixes

- Fix error on initial compile with no models created yet ([#70](https://github.com/get-select/dbt-snowflake-monitoring/pull/70))



## dbt-snowflake-monitoring 1.4.2 - January 12, 2023

### Fixes

- Inner join daily_rates to avoid $0 entries in daily_spend for incomplete days ([#66](https://github.com/get-select/dbt-snowflake-monitoring/pull/66))



## dbt-snowflake-monitoring 1.4.1 - January 06, 2023

### Fixes

- Increase incremental lookback window to account for changing cost data ([#64](https://github.com/get-select/dbt-snowflake-monitoring/pull/64))



## dbt-snowflake-monitoring 1.4.0 - January 06, 2023

### Features

- Add remaining balance daily model ([#58](https://github.com/get-select/dbt-snowflake-monitoring/pull/58))
- Improve cost per query freshness by using latest rates ([#52](https://github.com/get-select/dbt-snowflake-monitoring/pull/52))

### Fixes

- Select correct overage vs. regular rate each day ([#59](https://github.com/get-select/dbt-snowflake-monitoring/pull/59))



## dbt-snowflake-monitoring 1.3.1 - December 31, 2022

### Features

- Support dbt_utils 1.0.0 ([#48](https://github.com/get-select/dbt-snowflake-monitoring/pull/48))

### Contributors
- [@GtheSheep](https://github.com/GtheSheep) (Features)


## dbt-snowflake-monitoring 1.3.0 - December 21, 2022

### Features

- Add dbt_queries model to easily understand dbt model costs with links to dbt Cloud ([#47](https://github.com/get-select/dbt-snowflake-monitoring/pull/47))



## dbt-snowflake-monitoring 1.2.3 - December 15, 2022

### Features

- Add serverless tasks history and spend ([#37](https://github.com/get-select/dbt-snowflake-monitoring/pull/37))
- Add `warehouse_cluster_status`, `warehouse_credits_map` and `warehouses_type2_dimension` models ([#40](https://github.com/get-select/dbt-snowflake-monitoring/pull/40))

### Contributors
- [@gthesheep](https://github.com/gthesheep) (Features)
- [@ian-whitestone](https://github.com/ian-whitestone) (Features)

## dbt-snowflake-monitoring 1.2.2 - December 05, 2022

### Fixes

- Show only complete days in daily_spend and materialize as table ([#34](https://github.com/get-select/dbt-snowflake-monitoring/pull/34))



## dbt-snowflake-monitoring 1.2.1 - December 04, 2022

### Fixes

- Fix account_locator var ([#33](https://github.com/get-select/dbt-snowflake-monitoring/pull/33))



## dbt-snowflake-monitoring 1.2.0 - November 26, 2022

### Features

- Add get_query_comment macro for model metadata in query history ([#29](https://github.com/get-select/dbt-snowflake-monitoring/pull/29))
- Support overage usage type for PAYG accounts ([#24](https://github.com/get-select/dbt-snowflake-monitoring/pull/24))

### Fixes

- Division by zero in cost_per_query model ([#27](https://github.com/get-select/dbt-snowflake-monitoring/pull/27))

### Contributors
- [@aphethean1](https://github.com/aphethean1) (Features, Fixes)


## dbt-snowflake-monitoring 1.1.0 - October 28, 2022

### Features

- Add daily_spend model which aligns with monthly bill ([#13](https://github.com/get-select/dbt-snowflake-monitoring/pull/13))


## dbt-snowflake-monitoring 1.0.0 - October 17, 2022

### Features

- Add query_history_enriched model with additional dimensions and cost ([#12](https://github.com/get-select/dbt-snowflake-monitoring/pull/12))
- Add cost per query model ([#1](https://github.com/get-select/dbt-snowflake-monitoring/pull/1))



